@using Invoices.Blazor.Layout.NavMenu
@inherits LayoutComponentBase
@inject DarkModeSwitchService DarkModeService
@implements IDisposable

<MudThemeProvider @bind-IsDarkMode="@DarkModeService.IsDarkMode" Theme="@StartTheme.Theme" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MainAppbar />
    <MudDrawer @bind-Open="DarkModeService.DrawerOpen"
               Elevation="2"
               Variant="DrawerVariant.Responsive"
               Breakpoint="Breakpoint.Md">
        <MudDrawerHeader>
            <MudText Typo="Typo.h5" Color="Color.Primary">
                <MudIcon Icon="@Icons.Material.Filled.Receipt" Class="mr-2" />
                Správa faktur
            </MudText>
        </MudDrawerHeader>
        <MainNavMenu />
    </MudDrawer>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.ExtraLarge" Class="my-4">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    protected override void OnInitialized()
    {
        DarkModeService.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        DarkModeService.OnChange -= StateHasChanged;
    }
}